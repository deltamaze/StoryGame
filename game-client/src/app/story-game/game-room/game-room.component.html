<div *ngIf="gameInfo != null" class="container">
  <div class="row">
    <div class="col-md-9">
      <!--gamebody and chat in single stacked column-->
      <div class="row">
        <div class="col-12">

          <!--If Owner and Round 0, display StartGame-->
          <!--If round zero, and not owner, display: 'Waiting for game to start'-->
          <!--If Round > 0 display StoryThusFar-->
          <div class="card card-outline-primary mb-3">
            <div style="margin: 10px;">
              <div>
                <h4 class="float-left">Story</h4>
                <p class="float-right">Current Round: {{gameInfo.currentRound}} / {{gameInfo.totalRounds}}</p>
              </div>
              <br />
              <br />
              <div class="card-text">
                <p>{{gameInfo.storyThusFar}}</p>
              </div>
            </div>
          </div>
          <div class="card card-outline-success mb-3">
            <div style="margin: 10px;">
              <div class="card-text">
                <div *ngIf="gameInfo.currentRound == 0">
                  <div *ngIf="gameInfo.creatorUid == gameService.user.uid ">
                    <button class="btn btn-success btn-md" [disabled]="disableButton" (click)="startGame()">StartGame</button>
                  </div>
                  <div *ngIf="gameInfo.creatorUid != gameService.user.uid && isHostStillInGame()">Please Wait for Host to Start Game!</div>
                  <div *ngIf="gameInfo.creatorUid != gameService.user.uid && isHostStillInGame() == false">Host Disconnected from game, game cannot start.</div>
                </div>
                <!--IfRound > 0 and Odd, and gameOver = False-->
                <div *ngIf="gameInfo.currentRound % 2 ==1 && gameInfo.currentRound > 0 && gameInfo.isGameOver == false">
                  <!--DEBUG-->
                  <!--<div *ngIf="1==1">-->
                  <div>
                    <h4 class="float-left">Enter a sentence!</h4>
                    <p class="float-right">Time Left: {{gameInfo.timeLeftInRound}}</p>
                  </div>
                  <br />
                  <br />
                  <form (ngSubmit)="submitIdea()">
                    <div class="form-group">
                      <input type="text" class="form-control" id="text" [(ngModel)]="ideaInput" name="text" maxlength="{{maxCharacterCount}}" required>
                    </div>
                    <span *ngIf="!isMyActionComplete()">
                      <button type="submit"  class="btn btn-primary">Submit Idea</button> {{(ideaInput)?.length}}/{{maxCharacterCount}}
                    </span>
                    <span *ngIf="isMyActionComplete()">
                      <button type="submit"  class="btn btn-success">Update</button> {{(ideaInput)?.length}}/{{maxCharacterCount}} <img src="../../../assets/glyphicons-Ok.png" alt="image"> <p>Your Idea was saved! You can make changes before time is up!</p>
                    </span>
                    
                  </form>
                </div>
                <!--IfRound > 0 and Even, and gameOver = False-->
                <div *ngIf="gameInfo.currentRound % 2 ==0 && gameInfo.currentRound > 0 && gameInfo.isGameOver == false">
                  <!--DEBUG-->
                  <!--<div *ngIf="1==1">-->
                  <div>
                    <h4 class="float-left">Vote on your favorite sentence!</h4>
                    <p class="float-right">Time Left: {{gameInfo.timeLeftInRound}}</p>
                  </div>
                  <br />
                  <br />
                  <div class="text" *ngFor="let round of playerInputs">
                    <!--Only Display Current Round - 1-->
                    <div *ngIf="displayThisRound(round.$key)">
                      <ul>
                        <div *ngFor="let input of round  | propToArray">
                          <li *ngIf="displayThisInput(input.key)">
                            {{input.value.input}} - <button class="btn btn-primary btn-sm" (click)="submiteVote(input.key)">Vote</button>
                          </li>
                        </div>
                      </ul>
                    </div>
                    <!--playerInputs.find(o => o.$key === (parseInt(gameInfo.currentRound)-1).toString())-->

                  </div>
                </div>
                <!--If Game Over-->
                <div *ngIf="gameInfo.isGameOver == true">
                  GameOver
                  <br />
                  {{gameInfo.gameOverReason}}
                </div>
              </div>
            </div>
          </div>

        </div>
        <div class="col-12">
          <div class="card card-outline-info mb-3">
            <div style="margin: 10px;">
              <h4 class="card-title">Chat</h4>
              <div class="card-text">
                <form (ngSubmit)="submitChatMessage()">
                  <div class="form-group">
                    <input type="text" class="form-control" id="text" [(ngModel)]="chatInput" name="text" maxlength="50" required>
                  </div>
                  <button type="submit" class="btn btn-success">Send</button> 
                  <br />
                </form>
                <div #list style="overflow-y:scroll; height:200px;" [scrollTop]="list.scrollHeight">
                  <ul>
                    <li class="text" *ngFor="let message of chatMessages">
                      {{message.username}} - {{message.message}}
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-3">
      <div class="card card-outline-warning mb-3">
        <div style="margin: 10px;">
          <h4 class="card-title">PlayerList</h4>
          <div class="card-text">
            <ul>
              <li class="text" *ngFor="let player of playerList">
                <ng-template [ngIf]="isWithin10Seconds(player.pingTime) ">
                    {{player.username}} - {{player.score}} <img *ngIf="player.isActionFinished" src="../../../assets/glyphicons-Ok.png" alt="image"> 
                </ng-template>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<ul class="list-unstyled">
  <!--<li>
    <button class="btn btn-primary btn-md" (click)="consoleTest()">ConsoleTest</button>
  </li>
  <br />
  <br />-->
  <li>
    <button class="btn btn-danger btn-md" (click)="leaveGame()">Leave Game</button>
  </li>
</ul>
<span class="red-text">{{status}}</span>

<!--<button class="btn btn-danger btn-md" (click)="consoleTest()">Console Test</button>-->